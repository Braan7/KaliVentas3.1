<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>KaliVentas | Panel de recargas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root{
      --bg:#020617;
      --panel:#020617;
      --sidebar:#020617;
      --card:#020617;
      --primary:#4f46e5;
      --primary-soft:#1d2455;
      --accent:#22c55e;
      --accent-soft:#064e3b;
      --danger:#f97373;
      --text:#f9fafb;
      --muted:#9ca3af;
      --border:#1f2937;
      --radius-lg:26px;
      --radius-md:18px;
      --radius-pill:999px;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{
      min-height:100vh;
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",system-ui,sans-serif;
      background:radial-gradient(circle at top,#020617 0,#000 60%);
      color:var(--text);
      display:flex;
    }
    a{text-decoration:none;color:inherit;}

    .layout{
      display:flex;
      width:100%;
      min-height:100vh;
    }

    .sidebar{
      width:270px;
      background:radial-gradient(circle at top left,#020617 0,#020617 40%,#000 100%);
      border-right:1px solid rgba(15,23,42,.95);
      padding:1.1rem .9rem 1.6rem;
      display:flex;
      flex-direction:column;
      position:sticky;
      top:0;
      max-height:100vh;
      overflow-y:auto;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:.6rem;
      margin-bottom:1rem;
    }
    .brand-badge{
      width:36px;height:36px;border-radius:999px;
      background:radial-gradient(circle at 30% 0,#38bdf8 0,#4f46e5 40%,#a855f7 100%);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 0 18px rgba(56,189,248,.9);
      font-weight:700;
    }
    .brand-text{display:flex;flex-direction:column;line-height:1.1;}
    .brand-title{
      font-size:.9rem;font-weight:700;text-transform:uppercase;letter-spacing:.12em;
    }
    .brand-sub{font-size:.7rem;color:var(--muted);}
    .sidebar-section-title{
      font-size:.75rem;
      text-transform:uppercase;
      letter-spacing:.15em;
      color:var(--muted);
      margin:1rem .25rem .35rem;
    }
    .menu-item{
      display:flex;
      align-items:center;
      gap:.55rem;
      padding:.45rem .55rem;
      border-radius:var(--radius-md);
      cursor:pointer;
      margin-bottom:.1rem;
      transition:background .16s, box-shadow .16s, transform .08s;
    }
    .menu-item:hover{
      background:rgba(15,23,42,.9);
      box-shadow:0 0 0 1px rgba(79,70,229,.4);
    }
    .menu-item.active{
      background:linear-gradient(to right,#0ea5e9,#6366f1);
      box-shadow:0 0 0 1px rgba(56,189,248,.8),0 0 18px rgba(56,189,248,.9);
      transform:translateY(-1px);
    }
    .menu-item.active .menu-label{color:#f9fafb;}
    .menu-item.active .sub{color:#e5e7eb;}
    .menu-icon{
      width:26px;height:26px;border-radius:999px;
      background:rgba(15,23,42,1);
      display:flex;align-items:center;justify-content:center;
      font-size:.85rem;
    }
    .menu-text{flex:1;}
    .menu-label{font-size:.82rem;}
    .sub{font-size:.72rem;color:var(--muted);}
    .menu-item-dot{
      width:8px;height:8px;border-radius:999px;
      background:transparent;
    }
    .menu-item.active .menu-item-dot{background:#22c55e;}

    .main{
      flex:1;
      padding:1.2rem 1rem 1.8rem;
      overflow-x:hidden;
      overflow-y:auto;
    }
    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:1rem;
    }
    .top-left{
      display:flex;
      flex-direction:column;
      gap:.2rem;
    }
    .top-title{font-size:.95rem;font-weight:600;}
    .top-sub{font-size:.75rem;color:var(--muted);}
    .user-pill{
      display:flex;
      align-items:center;
      gap:.4rem;
      padding:.35rem .7rem;
      border-radius:var(--radius-pill);
      background:rgba(15,23,42,.9);
      font-size:.75rem;
    }
    .user-avatar{
      width:24px;height:24px;border-radius:999px;
      background:radial-gradient(circle at 30% 0,#38bdf8 0,#4f46e5 40%,#a855f7 100%);
      display:flex;align-items:center;justify-content:center;
      font-size:.8rem;
    }

    .content{display:none;animation:fade .18s ease-out;}
    .content.active{display:block;}
    @keyframes fade{from{opacity:0;transform:translateY(4px);}to{opacity:1;transform:none;}}

    .grid{
      display:grid;
      grid-template-columns:2.1fr 1.4fr;
      gap:1rem;
    }
    .card{
      background:radial-gradient(circle at top,#020617 0,#020617 60%,#000 100%);
      border-radius:var(--radius-lg);
      border:1px solid rgba(15,23,42,.9);
      padding:1rem 1.1rem;
      box-shadow:0 18px 40px rgba(15,23,42,.8);
    }
    .card-header{
      display:flex;justify-content:space-between;align-items:center;margin-bottom:.7rem;
    }
    .card-title{font-size:.9rem;font-weight:600;}
    .card-sub{font-size:.75rem;color:var(--muted);}
    .badge-outline{
      font-size:.7rem;
      padding:.2rem .55rem;
      border-radius:var(--radius-pill);
      border:1px solid rgba(148,163,184,.6);
      color:#e5e7eb;
    }
    .wallet-amount{
      font-size:1.5rem;
      font-weight:700;
      margin-bottom:.5rem;
      text-shadow:0 0 18px rgba(56,189,248,.9);
    }
    .btn-sm{
      border:none;
      border-radius:var(--radius-pill);
      padding:.38rem .8rem;
      font-size:.78rem;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:.3rem;
      background:linear-gradient(to right,#0ea5e9,#6366f1);
      color:#ecfeff;
    }
    .btn-secondary{
      border-radius:var(--radius-pill);
      padding:.38rem .8rem;
      font-size:.78rem;
      border:1px solid rgba(148,163,184,.6);
      background:rgba(15,23,42,1);
      color:#e5e7eb;
      cursor:pointer;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:.3rem;
      font-size:.75rem;
      padding:.2rem .55rem;
      border-radius:var(--radius-pill);
      background:rgba(15,23,42,1);
      margin-top:.3rem;
    }

    .quick-grid{
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:.7rem;
      margin-top:.7rem;
    }
    .quick-card{
      border-radius:var(--radius-md);
      border:1px solid rgba(15,23,42,.9);
      background:radial-gradient(circle at top,#020617 0,#020617 60%,#000 100%);
      padding:.7rem .7rem .8rem;
      font-size:.8rem;
    }
    .quick-top{
      display:flex;align-items:center;justify-content:space-between;margin-bottom:.25rem;
    }
    .quick-icon{
      width:26px;height:26px;border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      background:rgba(15,23,42,1);
      font-size:.9rem;
    }
    .quick-label{font-size:.8rem;}
    .quick-main{font-size:1rem;font-weight:600;margin:.1rem 0 .25rem;}
    .quick-link{
      font-size:.75rem;
      color:#38bdf8;
      display:inline-flex;
      align-items:center;
      gap:.18rem;
      cursor:pointer;
    }

    .section-tag{
      font-size:.7rem;
      text-transform:uppercase;
      letter-spacing:.14em;
      color:#a5b4fc;
      margin-bottom:.25rem;
    }
    h1.section-title{
      font-size:1.1rem;
      margin-bottom:.3rem;
    }
    .section-sub{
      font-size:.8rem;
      color:var(--muted);
      margin-bottom:.8rem;
    }
    .section-sub.small{font-size:.76rem;}

    .products-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
      gap:.8rem;
    }
    .product-card{
      border-radius:var(--radius-lg);
      border:1px solid rgba(15,23,42,.9);
      background:radial-gradient(circle at top,#020617 0,#020617 60%,#000 100%);
      padding:.8rem .9rem;
      font-size:.8rem;
    }
    .product-header{
      display:flex;gap:.55rem;margin-bottom:.3rem;align-items:center;
    }
    .product-icon{
      width:32px;height:32px;border-radius:999px;
      background:rgba(15,23,42,1);
      display:flex;align-items:center;justify-content:center;
      font-size:1rem;
    }
    .product-title{font-size:.9rem;font-weight:600;}
    .product-sub{font-size:.75rem;color:var(--muted);}
    .product-row{
      display:flex;flex-wrap:wrap;align-items:center;
      justify-content:space-between;
      gap:.4rem;
      margin-top:.4rem;
    }
    .product-select{
      flex:1 1 150px;
      border-radius:var(--radius-pill);
      border:1px solid rgba(31,41,55,1);
      background:#020617;
      color:var(--text);
      padding:.4rem .6rem;
      font-size:.8rem;
    }
    .product-input{
      flex:1 1 120px;
      border-radius:var(--radius-pill);
      border:1px solid rgba(31,41,55,1);
      background:#020617;
      color:var(--text);
      padding:.4rem .6rem;
      font-size:.8rem;
    }
    .product-actions{
      display:flex;
      gap:.35rem;
      margin-top:.5rem;
      flex-wrap:wrap;
    }
    .btn-ghost{
      border-radius:var(--radius-pill);
      border:1px solid rgba(148,163,184,.6);
      background:rgba(15,23,42,1);
      color:#e5e7eb;
      padding:.35rem .7rem;
      font-size:.78rem;
      cursor:pointer;
    }

    table{
      width:100%;
      border-collapse:collapse;
      font-size:.78rem;
    }
    th,td{
      padding:.45rem .5rem;
      border-bottom:1px solid rgba(31,41,55,1);
      text-align:left;
    }
    th{font-weight:500;color:var(--muted);}
    tr:last-child td{border-bottom:none;}

    .badge-green{
      padding:.18rem .45rem;border-radius:var(--radius-pill);
      background:rgba(16,185,129,.16);color:#6ee7b7;font-size:.72rem;
    }
    .badge-yellow{
      padding:.18rem .45rem;border-radius:var(--radius-pill);
      background:rgba(250,204,21,.12);color:#facc15;font-size:.72rem;
    }

    .tabs{
      display:flex;
      gap:.4rem;
      margin-bottom:.7rem;
      flex-wrap:wrap;
    }
    .tab{
      border-radius:var(--radius-pill);
      padding:.32rem .7rem;
      font-size:.78rem;
      border:1px solid rgba(55,65,81,1);
      background:#020617;
      cursor:pointer;
    }
    .tab.active{
      background:linear-gradient(to right,#0ea5e9,#6366f1);
      border-color:transparent;
      color:#ecfeff;
    }
    .ranking-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:.9rem;
    }
    .ranking-card{
      border-radius:var(--radius-lg);
      border:1px solid rgba(15,23,42,.9);
      background:radial-gradient(circle at top,#020617 0,#020617 60%,#000 100%);
      padding:.9rem;
    }
    .ranking-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:.35rem 0;
      border-bottom:1px solid rgba(31,41,55,1);
      font-size:.8rem;
    }
    .ranking-row:last-child{border-bottom:none;}
    .ranking-left{
      display:flex;
      align-items:center;
      gap:.4rem;
    }
    .ranking-badge{
      width:24px;height:24px;border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      font-size:.8rem;
      background:rgba(15,23,42,1);
    }
    .ranking-name{font-size:.82rem;}
    .ranking-meta{font-size:.72rem;color:var(--muted);}
    .ranking-amount{
      font-size:.85rem;font-weight:600;
      text-shadow:0 0 12px rgba(56,189,248,.9);
    }

    .muted{color:var(--muted);font-size:.76rem;}
    .mt-sm{margin-top:.35rem;}
    .mt-md{margin-top:.7rem;}
    .mt-lg{margin-top:1.1rem;}

    @media (max-width:900px){
      .sidebar{display:none;}
      .main{padding:.8rem .7rem 1.2rem;}
      .grid{grid-template-columns:1fr;}
    }
  </style>
</head>
<body>
<div class="layout">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">
      <div class="brand-badge">KV</div>
      <div class="brand-text">
        <div class="brand-title">KALIVENTAS</div>
        <div class="brand-sub">Panel revendedores</div>
      </div>
    </div>

    <div class="sidebar-section-title">General</div>

    <div class="menu-item active" data-section="inicio">
      <div class="menu-icon">üè†</div>
      <div class="menu-text">
        <div class="menu-label">Inicio</div>
        <div class="sub">Resumen de tu cuenta</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="juegos">
      <div class="menu-icon">üéÆ</div>
      <div class="menu-text">
        <div class="menu-label">Recargas videojuegos</div>
        <div class="sub">Free Fire, PUBG, CODM, etc.</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="streaming">
      <div class="menu-icon">üì∫</div>
      <div class="menu-text">
        <div class="menu-label">Streaming</div>
        <div class="sub">Netflix, Disney+, Spotify‚Ä¶</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="pagos">
      <div class="menu-icon">üí≥</div>
      <div class="menu-text">
        <div class="menu-label">M√©todos de pago</div>
        <div class="sub">Stori, OXXO, Binance, LTC</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="sidebar-section-title">Mi cuenta</div>

    <div class="menu-item" data-section="dashboard">
      <div class="menu-icon">üìä</div>
      <div class="menu-text">
        <div class="menu-label">Mi dashboard</div>
        <div class="sub">Resumen r√°pido</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="saldo">
      <div class="menu-icon">‚ûï</div>
      <div class="menu-text">
        <div class="menu-label">Recargar saldo</div>
        <div class="sub">Formulario para comprobante</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="intl">
      <div class="menu-icon">üåç</div>
      <div class="menu-text">
        <div class="menu-label">Recarga internacional</div>
        <div class="sub">Saldo global y retiros</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="orders">
      <div class="menu-icon">üßæ</div>
      <div class="menu-text">
        <div class="menu-label">Mis compras</div>
        <div class="sub">Historial de pedidos</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="rango">
      <div class="menu-icon">‚≠ê</div>
      <div class="menu-text">
        <div class="menu-label">Mi rango</div>
        <div class="sub">Niveles y descuentos</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="ranking">
      <div class="menu-icon">üèÜ</div>
      <div class="menu-text">
        <div class="menu-label">Mi ranking</div>
        <div class="sub">Top recargas y gastos</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="sidebar-section-title">Otros</div>

    <div class="menu-item" data-section="smm">
      <div class="menu-icon">üöÄ</div>
      <div class="menu-text">
        <div class="menu-label">SmmProdigyX</div>
        <div class="sub">API externa redes sociales</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="comida">
      <div class="menu-icon">üçî</div>
      <div class="menu-text">
        <div class="menu-label">ComidaMaster</div>
        <div class="sub">API pedidos de comida</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>

    <div class="menu-item" data-section="admin" id="menu-admin" style="display:none;">
      <div class="menu-icon">üõ†Ô∏è</div>
      <div class="menu-text">
        <div class="menu-label">Admin</div>
        <div class="sub">Gesti√≥n interna</div>
      </div>
      <div class="menu-item-dot"></div>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">
    <header class="topbar">
      <div class="top-left">
        <div class="top-title" id="top-welcome">Sesi√≥n activa</div>
        <div class="top-sub" id="top-subtitle">
          Bienvenido a tu panel KaliVentas.
        </div>
      </div>
      <div class="user-pill" id="top-user-pill">
        <div class="user-avatar" id="top-avatar">KV</div>
       <div>
          <div style="font-size:.78rem;" id="top-user-name">Usuario invitado</div>
          <div style="font-size:.7rem;color:var(--muted);" id="top-user-role">REVENDEDOR ¬∑ DEMO</div>
        </div>
      </div>
    </header>

    <!-- INICIO -->
    <section class="content active" id="section-inicio">
      <div class="grid">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Bienvenido, <span id="home-name">Revendedor</span></div>
              <div class="card-sub">Administra tu cuenta y revisa tu saldo (simulado).</div>
            </div>
            <span class="badge-outline" id="home-id">ID #KALI001</span>
          </div>

          <div style="display:flex;gap:.8rem;flex-wrap:wrap;margin-bottom:.8rem;">
            <div style="flex:1 1 180px;" class="card">
              <div class="card-header">
                <span class="card-title">Saldo normal</span>
              </div>
              <div class="wallet-amount" id="home-saldo">$0.00 MXN</div>
              <button class="btn-sm" data-goto="saldo">‚ûï Recargar saldo</button>
              <div class="muted mt-sm">El saldo real se confirma al aprobar tus recargas.</div>
            </div>

            <div style="flex:1 1 180px;" class="card">
              <div class="card-header">
                <span class="card-title">Saldo bonus</span>
              </div>
              <div class="wallet-amount" id="home-bonus">$0.00 MXN</div>
              <span class="muted">Solo productos elegibles.</span>
            </div>
          </div>

          <div class="quick-grid">
            <div class="quick-card">
              <div class="quick-top">
                <div class="quick-icon">üßæ</div>
                <span class="badge-outline">Historial</span>
              </div>
              <div class="quick-label">Mis compras</div>
              <div class="quick-main" id="home-orders-count">0 compras</div>
              <div class="quick-link" data-goto="orders">üëÄ Ver todas</div>
            </div>
            <div class="quick-card">
              <div class="quick-top">
                <div class="quick-icon">üì≤</div>
                <span class="badge-outline">WhatsApp</span>
              </div>
              <div class="quick-label">Soporte directo</div>
              <div class="quick-main">+52 56 4880 4810</div>
              <a class="quick-link" id="home-whatsapp" target="_blank">üí¨ Escribir ahora</a>
            </div>
            <div class="quick-card">
              <div class="quick-top">
                <div class="quick-icon">‚öôÔ∏è</div>
              </div>
              <div class="quick-label">Datos del revendedor</div>
              <div class="quick-main" id="home-store">Mi tienda</div>
              <div class="quick-link" data-goto="dashboard">‚úèÔ∏è Ajustar despu√©s</div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Productos destacados</div>
              <div class="card-sub">Atajos r√°pidos.</div>
            </div>
          </div>

          <div class="products-grid">
            <article class="product-card">
              <div class="product-header">
                <div class="product-icon">üíé</div>
                <div>
                  <div class="product-title">Free Fire ‚Ä¢ Diamantes x ID</div>
                  <div class="product-sub">Recargas por ID/Pin con saldo del panel.</div>
                </div>
              </div>
              <div class="product-row">
                <select class="product-select">
                  <option>110 üíé ‚Äî $17 MXN</option>
                  <option>341 üíé ‚Äî $56 MXN</option>
                  <option>572 üíé ‚Äî $85 MXN</option>
                  <option>1166 üíé ‚Äî $175 MXN</option>
                </select>
              </div>
              <div class="product-actions">
                <button class="btn-sm" data-goto="juegos">Ver m√°s recargas</button>
              </div>
            </article>

            <article class="product-card">
              <div class="product-header">
                <div class="product-icon">üì∫</div>
                <div>
                  <div class="product-title">Servicios de streaming</div>
                  <div class="product-sub">Netflix, Disney+, Spotify y m√°s.</div>
                </div>
              </div>
              <div class="product-actions">
                <button class="btn-sm" data-goto="streaming">Ver cat√°logo streaming</button>
              </div>
            </article>
          </div>
        </div>
      </div>
    </section>

    <!-- RECARGAS VIDEOJUEGOS -->
    <section class="content" id="section-juegos">
      <div class="section-tag">Recargas</div>
      <h1 class="section-title">Recargas de videojuegos</h1>
      <p class="section-sub">
        Todos los precios se procesan con saldo del panel. Env√≠a siempre tu ID y nombre exactos.
      </p>

      <div class="products-grid">
        <!-- Free Fire -->
        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üíé</div>
            <div>
              <div class="product-title">Free Fire ‚Ä¢ Diamantes x ID</div>
              <div class="product-sub">Recargas r√°pidas por ID / PIN.</div>
            </div>
          </div>
          <div class="product-row">
            <select class="product-select" id="ff-pack">
              <option value="110|17">110 üíé ‚Äî $17 MXN</option>
              <option value="341|56">341 üíé ‚Äî $56 MXN</option>
              <option value="572|85">572 üíé ‚Äî $85 MXN</option>
              <option value="1166|175">1166 üíé ‚Äî $175 MXN</option>
              <option value="2398|300">2398 üíé ‚Äî $300 MXN</option>
              <option value="6160|710">6160 üíé ‚Äî $710 MXN</option>
            </select>
          </div>
          <div class="product-row">
            <input class="product-input" id="ff-id" placeholder="ID del jugador" />
            <input class="product-input" id="ff-name" placeholder="Nombre del jugador" />
            <input class="product-input" id="ff-region" placeholder="Regi√≥n (Latam, USA‚Ä¶)" />
          </div>
          <div class="product-actions">
            <button class="btn-sm" data-action="ff-order">Comprar con saldo</button>
            <button class="btn-ghost" data-action="ff-whatsapp">Confirmar por WhatsApp</button>
          </div>
          <p class="section-sub small mt-sm">
            Solo se acepta pago con saldo disponible en el panel. Confirma siempre que el ID est√© correcto.
          </p>
        </article>

        <!-- Ejemplos PUBG / Fortnite / CODM -->
        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üéØ</div>
            <div>
              <div class="product-title">PUBG Mobile</div>
              <div class="product-sub">UC por ID (ilustrativo).</div>
            </div>
          </div>
          <div class="product-row">
            <select class="product-select">
              <option>60 UC ‚Äî $22 MXN</option>
              <option>325 UC ‚Äî $99 MXN</option>
              <option>660 UC ‚Äî $190 MXN</option>
            </select>
          </div>
          <div class="product-row">
            <input class="product-input" placeholder="ID del jugador" />
            <input class="product-input" placeholder="Nombre del jugador" />
          </div>
          <div class="product-actions">
            <button class="btn-sm">Agregar al carrito</button>
            <button class="btn-ghost">Confirmar por WhatsApp</button>
          </div>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üåÄ</div>
            <div>
              <div class="product-title">Fortnite</div>
              <div class="product-sub">PaVos por Epic ID / correo.</div>
            </div>
          </div>
          <div class="product-row">
            <select class="product-select">
              <option>1000 V-Bucks ‚Äî $190 MXN</option>
              <option>2800 V-Bucks ‚Äî $480 MXN</option>
            </select>
          </div>
          <div class="product-row">
            <input class="product-input" placeholder="Epic ID / correo" />
          </div>
          <div class="product-actions">
            <button class="btn-sm">Comprar con saldo</button>
          </div>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üî´</div>
            <div>
              <div class="product-title">COD Mobile</div>
              <div class="product-sub">CP por ID / UID.</div>
            </div>
          </div>
          <div class="product-row">
            <select class="product-select">
              <option>80 CP ‚Äî $25 MXN</option>
              <option>420 CP ‚Äî $120 MXN</option>
            </select>
          </div>
          <div class="product-row">
            <input class="product-input" placeholder="UID del jugador" />
          </div>
          <div class="product-actions">
            <button class="btn-sm">Comprar con saldo</button>
          </div>
        </article>
      </div>
    </section>

    <!-- STREAMING -->
    <section class="content" id="section-streaming">
      <div class="section-tag">Streaming</div>
      <h1 class="section-title">Servicios de streaming</h1>
      <p class="section-sub">
        Maneja cuentas de Netflix, Disney+, Spotify y m√°s (ilustrativo).
      </p>

      <div class="products-grid">
        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üé¨</div>
            <div>
              <div class="product-title">Netflix Premium</div>
              <div class="product-sub">Perfil privado 1 mes.</div>
            </div>
          </div>
          <div class="product-row">
            <select class="product-select">
              <option>1 mes ‚Äî $120 MXN</option>
              <option>3 meses ‚Äî $330 MXN</option>
            </select>
          </div>
          <div class="product-actions">
            <button class="btn-sm">Comprar con saldo</button>
            <button class="btn-ghost">Solicitar por WhatsApp</button>
          </div>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üéß</div>
            <div>
              <div class="product-title">Spotify Premium</div>
              <div class="product-sub">Cuenta individual o Duo.</div>
            </div>
          </div>
          <div class="product-row">
            <select class="product-select">
              <option>1 mes ‚Äî $90 MXN</option>
              <option>3 meses ‚Äî $260 MXN</option>
            </select>
          </div>
          <div class="product-actions">
            <button class="btn-sm">Comprar con saldo</button>
          </div>
        </article>
      </div>
    </section>

    <!-- M√âTODOS DE PAGO -->
    <section class="content" id="section-pagos">
      <div class="section-tag">Pagos</div>
      <h1 class="section-title">M√©todos de pago KaliVentas</h1>
      <p class="section-sub">
        Datos fijos para que los revendedores env√≠en saldo. Pide siempre comprobante.
      </p>

      <div class="products-grid">
        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üè¶</div>
            <div>
              <div class="product-title">Transferencia MX (Stori)</div>
              <div class="product-sub">Dep√≥sitos bancarios nacionales.</div>
            </div>
          </div>
          <p class="mt-sm section-sub small">
            <strong>Tarjeta:</strong> 6461 8040 2332 9646 86<br/>
            <strong>Nombre:</strong> Matiana Rubi<br/>
            <strong>Banco:</strong> Stori
          </p>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üè™</div>
            <div>
              <div class="product-title">Dep√≥sito OXXO</div>
              <div class="product-sub">Referencia directa a tarjeta.</div>
            </div>
          </div>
          <p class="mt-sm section-sub small">
            <strong>N√∫mero OXXO:</strong><br/>
            2242 1701 8069 2308
          </p>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">ü™ô</div>
            <div>
              <div class="product-title">Binance</div>
              <div class="product-sub">ID o USDT (TRC20).</div>
            </div>
          </div>
          <p class="mt-sm section-sub small">
            <strong>Binance ID:</strong> 1106987175<br/>
            <strong>USDT (TRC20):</strong> TKkrmoStfuqpjP6C8oooJPqcuKchn8Gbdf
          </p>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üí†</div>
            <div>
              <div class="product-title">Litecoin (LTC)</div>
              <div class="product-sub">Pagos cripto r√°pidos.</div>
            </div>
          </div>
          <p class="mt-sm section-sub small">
            <strong>Wallet LTC:</strong><br/>
            LYxnZA4b2TFbBopARSj29Md7J1gfsuGAhS
          </p>
        </article>
      </div>
    </section>

    <!-- MI DASHBOARD -->
    <section class="content" id="section-dashboard">
      <div class="section-tag">Panel</div>
      <h1 class="section-title">Mi dashboard</h1>
      <p class="section-sub">
        Resumen r√°pido de saldos y accesos directos.
      </p>

      <div class="grid">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Resumen de saldo</div>
              <div class="card-sub">Vista r√°pida.</div>
            </div>
          </div>
          <table>
            <thead>
            <tr>
              <th>Tipo</th>
              <th>Monto</th>
              <th>Notas</th>
            </tr>
            </thead>
            <tbody>
            <tr>
              <td>Saldo normal</td>
              <td id="dash-saldo">$0.00 MXN</td>
              <td>Disponible para recargas.</td>
            </tr>
            <tr>
              <td>Saldo bonus</td>
              <td id="dash-bonus">$0.00 MXN</td>
              <td>Solo productos elegibles.</td>
            </tr>
            </tbody>
          </table>
        </div>

        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Actividad r√°pida</div>
              <div class="card-sub">Accesos directos.</div>
            </div>
          </div>
          <div class="quick-grid" style="grid-template-columns:1fr 1fr;">
            <div class="quick-card">
              <div class="quick-top">
                <div class="quick-icon">‚ûï</div>
              </div>
              <div class="quick-label">Recargar saldo</div>
              <div class="quick-main">Desde $200 MXN</div>
              <div class="quick-link" data-goto="saldo">Ir a recargas</div>
            </div>
            <div class="quick-card">
              <div class="quick-top">
                <div class="quick-icon">üéÆ</div>
              </div>
              <div class="quick-label">Recargas de juegos</div>
              <div class="quick-main">Cat√°logo completo</div>
              <div class="quick-link" data-goto="juegos">Ver cat√°logo</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- RECARGAR SALDO -->
    <section class="content" id="section-saldo">
      <div class="section-tag">Saldo</div>
      <h1 class="section-title">Recargar saldo</h1>
      <p class="section-sub">
        M√≠nimo sugerido para revendedores: <strong>$200 MXN</strong>.
        Crea la solicitud y luego env√≠a tu comprobante por WhatsApp.
      </p>

      <div class="products-grid">
        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üè¶</div>
            <div>
              <div class="product-title">Transferencia MX (Stori)</div>
              <div class="product-sub">Dep√≥sitos desde banca mexicana.</div>
            </div>
          </div>
          <p class="section-sub small">
            Tarjeta: 6461 8040 2332 9646 86<br/>
            Nombre: Matiana Rubi<br/>
            Banco: Stori
          </p>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üè™</div>
            <div>
              <div class="product-title">Dep√≥sito OXXO</div>
              <div class="product-sub">Ll√©vale este n√∫mero al cajero.</div>
            </div>
          </div>
          <p class="section-sub small">
            Dep√≥sito OXXO:<br/>
            2242 1701 8069 2308
          </p>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">ü™ô</div>
            <div>
              <div class="product-title">Binance USDT / ID</div>
              <div class="product-sub">Pagos cripto r√°pidos.</div>
            </div>
          </div>
          <p class="section-sub small">
            Binance ID: 1106987175<br/>
            USDT (TRC20): TKkrmoStfuqpjP6C8oooJPqcuKchn8Gbdf
          </p>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üí†</div>
            <div>
              <div class="product-title">Litecoin (LTC)</div>
              <div class="product-sub">Pagos en Litecoin.</div>
            </div>
          </div>
          <p class="section-sub small">
            Wallet LTC:<br/>
            LYxnZA4b2TFbBopARSj29Md7J1gfsuGAhS
          </p>
        </article>
      </div>

      <div class="card mt-md">
        <div class="card-header">
          <div>
            <div class="card-title">Enviar comprobante por WhatsApp</div>
            <div class="card-sub">Llena estos datos y abre el chat listo.</div>
          </div>
        </div>
        <div class="products-grid">
          <div class="product-card">
            <div class="product-row">
              <input class="product-input" id="topup-amount" placeholder="Monto enviado (MXN)" />
              <input class="product-input" id="topup-bank" placeholder="Banco / m√©todo (Stori, OXXO, Binance...)" />
            </div>
            <div class="product-row">
              <input class="product-input" id="topup-ref" placeholder="√öltimos d√≠gitos / referencia" />
            </div>
            <div class="product-actions">
              <button class="btn-sm" id="btn-topup-whatsapp">Crear solicitud + WhatsApp</button>
              <span class="muted">Primero se registra como PENDIENTE en el sistema.</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- RECARGA INTERNACIONAL -->
    <section class="content" id="section-intl">
      <div class="section-tag">Global</div>
      <h1 class="section-title">Recarga internacional y retiros</h1>
      <p class="section-sub">
        M√≥dulo demo para manejar saldo global en USD y retiros (a futuro).
      </p>

      <div class="tabs">
        <button class="tab active" data-intl-tab="deposit">Recargar saldo</button>
        <button class="tab" data-intl-tab="withdraw">Retirar ganancias</button>
      </div>

      <div id="intl-deposit" class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Recargar saldo internacional</div>
            <div class="card-sub">Aqu√≠ ir√°n bancos de otros pa√≠ses.</div>
          </div>
        </div>
        <p class="section-sub small">
          De momento solo es visual. Cuando se agreguen bancos externos, se conectar√°n aqu√≠.
        </p>
      </div>

      <div id="intl-withdraw" class="card" style="display:none;">
        <div class="card-header">
          <div>
            <div class="card-title">Retirar fondos</div>
            <div class="card-sub">
              Saldo disponible (demo): <span style="color:#4ade80;" id="intl-balance">$10.00 USD</span>
            </div>
          </div>
        </div>

        <div class="products-grid">
          <article class="product-card">
            <div class="product-header">
              <div class="product-icon">ü™ô</div>
              <div>
                <div class="product-title">Binance</div>
                <div class="product-sub">Pay / ID</div>
              </div>
            </div>
          </article>
          <article class="product-card">
            <div class="product-header">
              <div class="product-icon">üí≥</div>
              <div>
                <div class="product-title">PayPal</div>
                <div class="product-sub">Correo electr√≥nico</div>
              </div>
            </div>
          </article>
        </div>

        <div class="mt-md">
          <label class="section-sub small">
            M√©todo de retiro
            <select class="product-select" id="intl-method">
              <option value="">Selecciona m√©todo</option>
              <option value="binance">Binance</option>
              <option value="paypal">PayPal</option>
            </select>
          </label>

          <label class="section-sub small mt-sm">
            Monto a retirar (USD)
            <input class="product-input" id="intl-amount" placeholder="M√≠nimo: $10.00" />
          </label>

          <div class="product-actions mt-sm">
            <button class="btn-sm" id="btn-intl-withdraw">üöÄ Solicitar retiro</button>
            <span class="muted">Demo visual, no env√≠a retiro real.</span>
          </div>
        </div>
      </div>
    </section>

    <!-- MIS COMPRAS -->
    <section class="content" id="section-orders">
      <div class="section-tag">Historial</div>
      <h1 class="section-title">Mis compras</h1>
      <p class="section-sub">
        Aqu√≠ ver√°s tus compras (de momento solo ilustrativas / localStorage).
      </p>

      <div class="card">
        <div class="card-header">
          <div class="card-title">Historial ilustrativo</div>
          <div class="card-sub" id="orders-count-sub">0 compras registradas.</div>
        </div>
        <table id="orders-table">
          <thead>
          <tr>
            <th>Fecha</th>
            <th>Producto</th>
            <th>Monto</th>
            <th>Estado</th>
          </tr>
          </thead>
          <tbody id="orders-body">
          <tr>
            <td colspan="4" class="muted">A√∫n no hay compras guardadas en este dispositivo.</td>
          </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- MI RANGO -->
    <section class="content" id="section-rango">
      <div class="section-tag">Niveles</div>
      <h1 class="section-title">Mi rango como revendedor</h1>
      <p class="section-sub">
        Rangos ilustrativos seg√∫n volumen de compras en USD.
      </p>

      <div class="products-grid">
        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üë§</div>
            <div>
              <div class="product-title">Usuario</div>
              <div class="product-sub">$0.00 ‚Äì $99.99 USD</div>
            </div>
          </div>
          <div class="badge-green">0% descuento</div>
          <span class="muted mt-sm">Nivel base.</span>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">‚≠ê</div>
            <div>
              <div class="product-title">VIP</div>
              <div class="product-sub">$100.00 ‚Äì $249.99 USD</div>
            </div>
          </div>
          <div class="badge-green">5% descuento</div>
          <span class="muted mt-sm">Bloqueado por ahora.</span>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üíé</div>
            <div>
              <div class="product-title">Premium</div>
              <div class="product-sub">$250.00 ‚Äì $499.99 USD</div>
            </div>
          </div>
          <div class="badge-green">10% descuento</div>
          <span class="muted mt-sm">Bloqueado por ahora.</span>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üî∑</div>
            <div>
              <div class="product-title">Diamond</div>
              <div class="product-sub">$500.00 ‚Äì $999.99 USD</div>
            </div>
          </div>
          <div class="badge-green">15% descuento</div>
          <span class="muted mt-sm">Bloqueado por ahora.</span>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üëë</div>
            <div>
              <div class="product-title">Deluxe</div>
              <div class="product-sub">$1,000.00 ‚Äì $4,999.99 USD</div>
            </div>
          </div>
          <div class="badge-green">20% descuento</div>
          <span class="muted mt-sm">Bloqueado por ahora.</span>
        </article>

        <article class="product-card">
          <div class="product-header">
            <div class="product-icon">üî•</div>
            <div>
              <div class="product-title">Elite</div>
              <div class="product-sub">$5,000.00+ USD</div>
            </div>
          </div>
          <div class="badge-green">30% descuento</div>
          <span class="muted mt-sm">Bloqueado por ahora.</span>
        </article>
      </div>
    </section>

    <!-- MI RANKING -->
    <section class="content" id="section-ranking">
      <div class="section-tag">Ranking</div>
      <h1 class="section-title">Mi ranking</h1>
      <p class="section-sub">
        Top recargas y top gastos (datos ilustrativos).
      </p>

      <div class="tabs">
        <button class="tab active" data-rank-tab="daily">Diario ($3)</button>
        <button class="tab" data-rank-tab="weekly">Semanal ($20)</button>
        <button class="tab" data-rank-tab="monthly">Mensual ($50)</button>
      </div>

      <div class="ranking-grid">
        <div class="ranking-card" id="rank-top-up">
          <div class="card-title" style="margin-bottom:.4rem;">Top recargas - hoy</div>
          <div class="ranking-row">
            <div class="ranking-left">
              <div class="ranking-badge">1</div>
              <div>
                <div class="ranking-name">SAG</div>
                <div class="ranking-meta">1 recarga</div>
              </div>
            </div>
            <div class="ranking-amount">$10.00</div>
          </div>
          <div class="ranking-row">
            <div class="ranking-left">
              <div class="ranking-badge">2</div>
              <div>
                <div class="ranking-name">ITACHI11</div>
                <div class="ranking-meta">1 recarga</div>
              </div>
            </div>
            <div class="ranking-amount">$10.00</div>
          </div>
          <div class="ranking-row">
            <div class="ranking-left">
              <div class="ranking-badge">3</div>
              <div>
                <div class="ranking-name">Diogo</div>
                <div class="ranking-meta">1 recarga</div>
              </div>
            </div>
            <div class="ranking-amount">$10.00</div>
          </div>
        </div>

        <div class="ranking-card" id="rank-top-spend">
          <div class="card-title" style="margin-bottom:.4rem;">Top gastos - hoy</div>
          <div class="ranking-row">
            <div class="ranking-left">
              <div class="ranking-badge">1</div>
              <div>
                <div class="ranking-name">yankarIosss</div>
                <div class="ranking-meta">1 compra</div>
              </div>
            </div>
            <div class="ranking-amount">$8.00</div>
          </div>
          <div class="ranking-row">
            <div class="ranking-left">
              <div class="ranking-badge">2</div>
              <div>
                <div class="ranking-name">MrFresaYT</div>
                <div class="ranking-meta">3 compras</div>
              </div>
            </div>
            <div class="ranking-amount">$6.24</div>
          </div>
          <div class="ranking-row">
            <div class="ranking-left">
              <div class="ranking-badge">3</div>
              <div>
                <div class="ranking-name">ITACHI11</div>
                <div class="ranking-meta">1 compra</div>
              </div>
            </div>
            <div class="ranking-amount">$6.00</div>
          </div>
        </div>
      </div>
    </section>

    <!-- SmmProdigyX -->
    <section class="content" id="section-smm">
      <div class="section-tag">APIs</div>
      <h1 class="section-title">SmmProdigyX</h1>
      <p class="section-sub">
        Conexi√≥n ilustrativa a tu API externa: <code>https://smmprodigyx.xyz/api/v2</code>.
      </p>
      <div class="card">
        <div class="card-title">Configuraci√≥n r√°pida</div>
        <p class="section-sub small mt-sm">
          M√°s adelante podr√°s conectar tu key real y hacer pedidos desde aqu√≠.
        </p>
      </div>
    </section>

    <!-- ComidaMaster -->
    <section class="content" id="section-comida">
      <div class="section-tag">APIs</div>
      <h1 class="section-title">ComidaMaster</h1>
      <p class="section-sub">
        API ilustrativa para pedidos de comida:<br />
        <code>https://comidamaster.net/public</code>
      </p>
      <div class="card">
        <div class="card-title">Panel de pedidos (demo)</div>
        <p class="section-sub small mt-sm">
          Aqu√≠ podr√≠as ver √≥rdenes de comida ligadas a tus revendedores cuando se conecte el backend.
        </p>
      </div>
    </section>

    <!-- ADMIN -->
   <section class="content" id="section-admin">
    <!-- aqu√≠ va todo el contenido de admin -->
</section>
      <div class="section-tag">Admin</div>
      <h1 class="section-title">Panel de administrador</h1>
      <p class="section-sub">
        Solo cuentas <strong>admin</strong> pueden ver esta secci√≥n. Aqu√≠ gestionas recargas, usuarios y productos.
      </p>

      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Recargas pendientes</div>
            <div class="card-sub">Aprueba o rechaza solicitudes de saldo.</div>
          </div>
        </div>
        <table>
          <thead>
          <tr>
            <th>ID</th>
            <th>Usuario</th>
            <th>Monto</th>
            <th>M√©todo</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
          </thead>
          <tbody id="admin-topups-body">
          <tr><td colspan="6" class="muted">Cargando recargas...</td></tr>
          </tbody>
        </table>
      </div>

      <div class="grid mt-md">
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Usuarios registrados</div>
              <div class="card-sub">Listado r√°pido de revendedores.</div>
            </div>
          </div>
          <table>
            <thead>
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Correo</th>
              <th>Rol</th>
            </tr>
            </thead>
            <tbody id="admin-users-body">
            <tr><td colspan="4" class="muted">Cargando usuarios...</td></tr>
            </tbody>
          </table>
        </div>

        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Productos</div>
              <div class="card-sub">Agregar o desactivar productos.</div>
            </div>
          </div>

          <table>
            <thead>
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Categor√≠a</th>
              <th>Precio</th>
              <th></th>
            </tr>
            </thead>
            <tbody id="admin-products-body">
            <tr><td colspan="5" class="muted">Cargando productos...</td></tr>
            </tbody>
          </table>

          <div class="mt-md">
            <p class="section-sub small"><strong>Agregar producto r√°pido</strong></p>
            <div class="product-row">
              <input class="product-input" id="prod-name" placeholder="Nombre" />
              <input class="product-input" id="prod-price" placeholder="Precio MXN" />
            </div>
            <div class="product-row">
              <input class="product-input" id="prod-cat" placeholder="Categor√≠a (juego, streaming...)" />
              <input class="product-input" id="prod-subcat" placeholder="Subcategor√≠a (freefire, pubg...)" />
            </div>
            <div class="product-actions">
              <button class="btn-sm" id="btn-add-product">‚ûï Agregar producto</button>
              <span class="muted">Se guardar√° en la tabla products del backend.</span>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>

<script>
  // ‚úÖ API REAL EN RENDER
  const API_BASE = "https://kaliventas-api.onrender.com/api";
  // ‚úÖ COINCIDE CON ADMIN_MASTER_PASSWORD EN RENDER
  const ADMIN_KEY = "KALI-ADMIN-777";

  function isAdmin(user) {
    if (!user) return false;
    if (user.isAdmin) return true;
    if (user.role && String(user.role).toLowerCase() === "admin") return true;
    return false;
  }

  function findCurrentUser() {
    try {
      const raw = localStorage.getItem("kaliventas_current_user");
      if (!raw) return null;
      return JSON.parse(raw);
    } catch (e) {
      console.error("Error leyendo usuario actual:", e);
      return null;
    }
  }

  function applyUserToUI(user) {
    const name = user && user.name ? user.name : "Revendedor";
    const email = user && user.email ? user.email : "";
    const phone = user && user.phone ? user.phone : "+52 56 4880 4810";
    const store = user && (user.store_name || user.store) ? (user.store_name || user.store) : "Mi tienda";
    const role = user && user.role ? user.role : "revendedor";
    const type = user && user.type ? user.type : (role === "admin" ? "Admin" : "Revendedor");

    const idBase = "KALI" + String(user && user.id ? user.id : 1).padStart(3, "0");

    document.getElementById("home-name").textContent = name;
    document.getElementById("home-id").textContent = "ID revendedor #" + idBase;

    const topName = document.getElementById("top-user-name");
    const topRole = document.getElementById("top-user-role");
    if (topName) topName.textContent = name;
    if (topRole) {
      const baseRole = isAdmin(user) ? "ADMIN ¬∑ " : "REVENDEDOR ¬∑ ";
      topRole.textContent = baseRole + String(type).toUpperCase();
    }

    const topSub = document.getElementById("top-subtitle");
    if (topSub) {
      topSub.textContent = "Sesi√≥n activa de " + (isAdmin(user) ? "admin" : "revendedor") +
        " para " + name + ".";
    }

    const avatarEl = document.getElementById("top-avatar");
    if (avatarEl && name) {
      avatarEl.textContent = (name[0] || "K").toUpperCase();
    }
    const homeStore = document.getElementById("home-store");
    if (homeStore) homeStore.textContent = store;

    const wBtn = document.getElementById("home-whatsapp");
    if (wBtn) {
      const msg = encodeURIComponent("Hola, soy " + name + " y quiero revisar mi panel de recargas.");
      wBtn.href = "https://wa.me/525648804810?text=" + msg;
    }

    const saldo = 0;
    const bonus = 0;
    const saldoTxt = "$" + saldo.toFixed(2) + " MXN";
    const bonusTxt = "$" + bonus.toFixed(2) + " MXN";

    const homeSaldo = document.getElementById("home-saldo");
    const homeBonus = document.getElementById("home-bonus");
    const dashSaldo = document.getElementById("dash-saldo");
    const dashBonus = document.getElementById("dash-bonus");
    if (homeSaldo) homeSaldo.textContent = saldoTxt;
    if (homeBonus) homeBonus.textContent = bonusTxt;
    if (dashSaldo) dashSaldo.textContent = saldoTxt;
    if (dashBonus) dashBonus.textContent = bonusTxt;
  }

  async function crearTopupDesdePanel(currentUser) {
    const amountEl = document.getElementById("topup-amount");
    const bankEl   = document.getElementById("topup-bank");
    const refEl    = document.getElementById("topup-ref");

    if (!amountEl || !bankEl) {
      alert("No se encontr√≥ el formulario de recarga.");
      return;
    }

    const amount = amountEl.value.trim();
    const method = bankEl.value.trim() || "stori";
    const reference = refEl ? refEl.value.trim() : "";

    if (!currentUser || !currentUser.id) {
      alert("No se encontr√≥ el usuario actual. Inicia sesi√≥n de nuevo.");
      return;
    }
    if (!amount) {
      alert("Escribe un monto para recargar.");
      return;
    }

    try {
      const res = await fetch(API_BASE + "/topups", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          userId: currentUser.id,
          amount_mxn: Number(amount),
          method,
          reference
        })
      });

      const data = await res.json();
      if (!res.ok) {
        console.error(data);
        alert("Error creando la solicitud: " + (data.error || "intenta de nuevo"));
        return;
      }

      alert("Solicitud de saldo creada como PENDIENTE en el sistema.");
    } catch (err) {
      console.error(err);
      alert("Error de conexi√≥n con el servidor.");
    }
  }

  async function cargarTopupsAdmin() {
    const bodyEl = document.getElementById("admin-topups-body");
    if (!bodyEl) return;
    bodyEl.innerHTML = `<tr><td colspan="6" class="muted">Cargando recargas...</td></tr>`;

    try {
      const res = await fetch(`${API_BASE}/admin/topups?adminKey=${encodeURIComponent(ADMIN_KEY)}&status=pendiente`);
      const data = await res.json();
      if (!res.ok) {
        console.error(data);
        bodyEl.innerHTML = `<tr><td colspan="6" class="muted">Error cargando recargas</td></tr>`;
        return;
      }

      if (!data.length) {
        bodyEl.innerHTML = `<tr><td colspan="6" class="muted">No hay recargas pendientes.</td></tr>`;
        return;
      }

      bodyEl.innerHTML = "";
      data.forEach((t) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${t.id}</td>
          <td>${t.user_name || "-"}<br/><span class="muted">${t.user_email || ""}</span></td>
          <td>$${t.amount_mxn}</td>
          <td>${t.method}</td>
          <td>${t.status}</td>
          <td>
            <button class="btn-sm" data-approve="${t.id}">Aprobar</button>
            <button class="btn-secondary" data-reject="${t.id}">Rechazar</button>
          </td>
        `;
        bodyEl.appendChild(tr);
      });

      bodyEl.onclick = async (e) => {
        const approveId = e.target.getAttribute("data-approve");
        const rejectId  = e.target.getAttribute("data-reject");
        if (approveId) {
          await actualizarTopupEstado(approveId, "aprobado");
          cargarTopupsAdmin();
        } else if (rejectId) {
          await actualizarTopupEstado(rejectId, "rechazado");
          cargarTopupsAdmin();
        }
      };
    } catch (err) {
      console.error(err);
      bodyEl.innerHTML = `<tr><td colspan="6" class="muted">Error de conexi√≥n</td></tr>`;
    }
  }

  async function actualizarTopupEstado(id, status) {
    try {
      const res = await fetch(
        `${API_BASE}/admin/topups/${id}?adminKey=${encodeURIComponent(ADMIN_KEY)}`,
        {
          method: "PATCH",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ status })
        }
      );
      const data = await res.json();
      if (!res.ok) {
        console.error(data);
        alert("Error actualizando estado.");
        return;
      }
      alert(`Topup #${id} marcado como ${status.toUpperCase()}`);
    } catch (err) {
      console.error(err);
      alert("Error de conexi√≥n al actualizar topup");
    }
  }

  async function cargarUsuariosAdmin() {
    const bodyEl = document.getElementById("admin-users-body");
    if (!bodyEl) return;
    bodyEl.innerHTML = `<tr><td colspan="4" class="muted">Cargando usuarios...</td></tr>`;

    try {
      const res = await fetch(`${API_BASE}/admin/users?adminKey=${encodeURIComponent(ADMIN_KEY)}`);
      const data = await res.json();
      if (!res.ok) {
        console.error(data);
        bodyEl.innerHTML = `<tr><td colspan="4" class="muted">Error cargando usuarios</td></tr>`;
        return;
      }

      if (!data.length) {
        bodyEl.innerHTML = `<tr><td colspan="4" class="muted">No hay usuarios registrados a√∫n.</td></tr>`;
        return;
      }

      bodyEl.innerHTML = "";
      data.forEach((u) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${u.id}</td>
          <td>${u.name || "-"}</td>
          <td>${u.email || "-"}</td>
          <td>${u.role || "revendedor"}</td>
        `;
        bodyEl.appendChild(tr);
      });
    } catch (err) {
      console.error(err);
      bodyEl.innerHTML = `<tr><td colspan="4" class="muted">Error de conexi√≥n</td></tr>`;
    }
  }

  async function cargarProductosAdmin() {
    const bodyEl = document.getElementById("admin-products-body");
    if (!bodyEl) return;
    bodyEl.innerHTML = `<tr><td colspan="5" class="muted">Cargando productos...</td></tr>`;

    try {
      const res = await fetch(`${API_BASE}/products`);
      const data = await res.json();
      if (!res.ok) {
        console.error(data);
        bodyEl.innerHTML = `<tr><td colspan="5" class="muted">Error cargando productos</td></tr>`;
        return;
      }

      if (!data.length) {
        bodyEl.innerHTML = `<tr><td colspan="5" class="muted">No hay productos activos.</td></tr>`;
        return;
      }

      bodyEl.innerHTML = "";
      data.forEach((p) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${p.id}</td>
          <td>${p.name}</td>
          <td>${p.category}${p.subcategory ? " / " + p.subcategory : ""}</td>
          <td>$${p.price_mxn}</td>
          <td><button class="btn-secondary" data-prod-off="${p.id}">Desactivar</button></td>
        `;
        bodyEl.appendChild(tr);
      });

      bodyEl.onclick = async (e) => {
        const id = e.target.getAttribute("data-prod-off");
        if (id) {
          if (!confirm("¬øDesactivar producto #" + id + "?")) return;
          await desactivarProducto(id);
          cargarProductosAdmin();
        }
      };
    } catch (err) {
      console.error(err);
      bodyEl.innerHTML = `<tr><td colspan="5" class="muted">Error de conexi√≥n</td></tr>`;
    }
  }

  async function desactivarProducto(id) {
    try {
      const res = await fetch(
        `${API_BASE}/admin/products/${id}?adminKey=${encodeURIComponent(ADMIN_KEY)}`,
        { method: "DELETE" }
      );
      const data = await res.json();
      if (!res.ok) {
        console.error(data);
        alert("Error desactivando producto");
        return;
      }
      alert("Producto #" + id + " desactivado.");
    } catch (err) {
      console.error(err);
      alert("Error de conexi√≥n al desactivar producto");
    }
  }

  async function agregarProductoAdmin() {
    const nameEl = document.getElementById("prod-name");
    const priceEl = document.getElementById("prod-price");
    const catEl = document.getElementById("prod-cat");
    const subcatEl = document.getElementById("prod-subcat");

    const name = nameEl.value.trim();
    const price = priceEl.value.trim();
    const category = catEl.value.trim() || "otro";
    const subcategory = subcatEl.value.trim();

    if (!name || !price) {
      alert("Nombre y precio son obligatorios.");
      return;
    }

    try {
      const res = await fetch(
        `${API_BASE}/admin/products?adminKey=${encodeURIComponent(ADMIN_KEY)}`,
        {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            name,
            category,
            subcategory,
            price_mxn: Number(price),
            description: ""
          })
        }
      );
      const data = await res.json();
      if (!res.ok) {
        console.error(data);
        alert("Error agregando producto: " + (data.error || "intenta de nuevo"));
        return;
      }

      alert("Producto agregado con √©xito (ID " + data.id + ").");
      nameEl.value = "";
      priceEl.value = "";
      catEl.value = "";
      subcatEl.value = "";
      cargarProductosAdmin();
    } catch (err) {
      console.error(err);
      alert("Error de conexi√≥n al agregar producto.");
    }
  }

  function loadOrdersLocal(currentUser) {
    const tbody = document.getElementById("orders-body");
    const sub   = document.getElementById("orders-count-sub");
    if (!tbody) return;

    let allOrders = [];
    try {
      const raw = localStorage.getItem("kaliventas_orders");
      if (raw) {
        const parsed = JSON.parse(raw);
        if (Array.isArray(parsed)) allOrders = parsed;
      }
    } catch (e) {}

    const userEmail = currentUser && currentUser.email ? currentUser.email.toLowerCase() : null;
    const orders = !userEmail ? allOrders : allOrders.filter(o => (o.email || "").toLowerCase() === userEmail);

    tbody.innerHTML = "";
    if (!orders.length) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.colSpan = 4;
      td.className = "muted";
      td.textContent = "A√∫n no hay compras guardadas en este dispositivo.";
      tr.appendChild(td);
      tbody.appendChild(tr);
    } else {
      orders.forEach(o => {
        const tr = document.createElement("tr");
        const fecha = document.createElement("td");
        fecha.textContent = o.date || "-";
        const prod = document.createElement("td");
        prod.textContent = o.product || "-";
        const amt = document.createElement("td");
        amt.textContent = o.amount || "-";
        const st = document.createElement("td");
        const span = document.createElement("span");
        span.className = o.status === "aprobado" ? "badge-green" : "badge-yellow";
        span.textContent = (o.status || "pendiente");
        st.appendChild(span);

        tr.appendChild(fecha);
        tr.appendChild(prod);
        tr.appendChild(amt);
        tr.appendChild(st);
        tbody.appendChild(tr);
      });
    }

    if (sub) {
      sub.textContent = orders.length + " compras en este dispositivo (ilustrativo).";
    }

    const homeCount = document.getElementById("home-orders-count");
    if (homeCount) homeCount.textContent = orders.length + " compras";
  }

  document.addEventListener("DOMContentLoaded", function () {
    const currentUser = findCurrentUser();
    if (!currentUser) {
      window.location.href = "login.html";
      return;
    }

    applyUserToUI(currentUser);
    loadOrdersLocal(currentUser);

    const adminMenu = document.getElementById("menu-admin");
    if (adminMenu) {
      adminMenu.style.display = isAdmin(currentUser) ? "flex" : "none";
    }

    const sections = {
      inicio:      document.getElementById("section-inicio"),
      juegos:      document.getElementById("section-juegos"),
      streaming:   document.getElementById("section-streaming"),
      pagos:       document.getElementById("section-pagos"),
      dashboard:   document.getElementById("section-dashboard"),
      saldo:       document.getElementById("section-saldo"),
      intl:        document.getElementById("section-intl"),
      orders:      document.getElementById("section-orders"),
      rango:       document.getElementById("section-rango"),
      ranking:     document.getElementById("section-ranking"),
      smm:         document.getElementById("section-smm"),
      comida:      document.getElementById("section-comida"),
      admin:       document.getElementById("section-admin")
    };

    function showSection(key) {
      Object.keys(sections).forEach(k => {
        if (!sections[k]) return;
        sections[k].classList.toggle("active", k === key);
      });
      document.querySelectorAll(".menu-item").forEach(item => {
        const sec = item.getAttribute("data-section");
        item.classList.toggle("active", sec === key);
      });

      if (key === "admin" && isAdmin(currentUser)) {
        cargarTopupsAdmin();
        cargarUsuariosAdmin();
        cargarProductosAdmin();
      }
    }

    document.querySelectorAll(".menu-item").forEach(item => {
      item.addEventListener("click", function () {
        const sec = item.getAttribute("data-section");
        if (!sec) return;
        if (sec === "admin" && !isAdmin(currentUser)) {
          alert("Esta secci√≥n solo est√° disponible para cuentas admin.");
          return;
        }
        showSection(sec);
      });
    });

    document.querySelectorAll("[data-goto]").forEach(el => {
      el.addEventListener("click", function () {
        const target = el.getAttribute("data-goto");
        if (target === "admin" && !isAdmin(currentUser)) {
          alert("Esta secci√≥n solo est√° disponible para cuentas admin.");
          return;
        }
        showSection(target);
      });
    });

    const intlTabs = document.querySelectorAll("[data-intl-tab]");
    intlTabs.forEach(tab => {
      tab.addEventListener("click", function () {
        intlTabs.forEach(t => t.classList.remove("active"));
        tab.classList.add("active");
        const key = tab.getAttribute("data-intl-tab");
        document.getElementById("intl-deposit").style.display = key === "deposit" ? "block" : "none";
        document.getElementById("intl-withdraw").style.display = key === "withdraw" ? "block" : "none";
      });
    });

    const btnTopup = document.getElementById("btn-topup-whatsapp");
    if (btnTopup) {
      btnTopup.addEventListener("click", function () {
        crearTopupDesdePanel(currentUser);

        const amount = document.getElementById("topup-amount").value.trim();
        const bank   = document.getElementById("topup-bank").value.trim();
        const ref    = document.getElementById("topup-ref").value.trim();
        const name   = currentUser && currentUser.name ? currentUser.name : "Revendedor";

        const msg = "Hola, soy " + name +
          "%0AQuiero recargar saldo en KaliVentas.%0A%0A" +
          "Monto: " + (amount || "N/D") + " MXN%0A" +
          "M√©todo: " + (bank || "N/D") + "%0A" +
          "Referencia: " + (ref || "N/D");

        window.open("https://wa.me/525648804810?text=" + msg, "_blank");
      });
    }

    const btnAddProduct = document.getElementById("btn-add-product");
    if (btnAddProduct) {
      btnAddProduct.addEventListener("click", function () {
        if (!isAdmin(currentUser)) {
          alert("Solo un admin puede agregar productos.");
          return;
        }
        agregarProductoAdmin();
      });
    }
  });
</script>
</body>
</html>
